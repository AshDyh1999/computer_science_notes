## 1. 基于POSIX的条件变量和线程实现线程池
### 1-1. 介绍
1. 结构体
    1. 线程池变量:宏观控制线程池
        1. 任务的链表
        2. 条件变量(以及配合的互斥锁)
        3. 线程信息
            1. 当前线程数
            2. 当前等待线程数(由于条件变量而等待)
            3. 最大线程数
    2. 任务:用户需要完成的任务
        1. 函数指针
        2. 函数参数
        3. 下一个任务(链表实现的任务集合)
2. 思路
    1. 添加任务
        1. 构造任务变量
        2. 互斥地添加到任务列表中
        3. 如果有线程因为条件变量而处于等待状态
            1. 通知他们
        4. 如果没有线程因为条件变量而处于等待状态,说明都是忙碌状态或者没有
            1. 创建1个线程
    2. 线程的入口函数
        1. while(1)
            1. 如果任务列表里没有任务或者线程池要销毁了
                1. 等待任务到来,如果超过超时时间,就不等待了
            2. 如果任务列表里已经有任务了
                1. 互斥地获得任务列表里的任务,并且删除任务列表中的该任务
                2. 执行任务
            3. 如果没有任务并且要求销毁
                1. 更新线程状态
                2. 如果自己是最后一个忙碌的线程
                    1. 通知线程池可以销毁了
            4. 如果没有任务并且是超时而退出
                1. 直接break退出循环
    3. 销毁线程池
        1. 如果已经销毁过了,就不销毁,直接退出
        2. (执行到这里说明还没销毁过)置销毁的flag为1
        3. 如果当前还有线程
            1. 如果还有因为条件变量而等待的线程
                1. 广播通知他们可以不用等待了(这时等待的线程应该可以由销毁的flag来退出的能力)
            2. 如果还有忙碌线程
                1. 等待最后一个处理完任务的线程发来通知
                    
### 2. 使用
```
make
./main 
#------------------------------------------------------------------------------
# 0x1cbe5700 is starting...
# 0x1cbe5700 is working on 0...
# 0x1c3e4700 is starting...
# 0x1bbe3700 is starting...
# 0x1bbe3700 is working on 2...
# 0x1c3e4700 is working on 1...
# 0x1cbe5700 is working on 3...
# 0x1bbe3700 is working on 4...
# 0x1c3e4700 is working on 5...
# 0x1cbe5700 is working on 6...
# 0x1bbe3700 is working on 7...
# 0x1c3e4700 is working on 8...
# 0x1cbe5700 is working on 9...
# 0x1bbe3700 is destroying...
# 0x1c3e4700 is destroying...
# 0x1cbe5700 is destroying...
#------------------------------------------------------------------------------

```
